
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>歌える曲リスト（CSVバックアップ付き）</title>
</head>
<body>
  <h1>🎵 歌える曲リスト</h1>
  <button onclick="downloadCSV()">💾 バックアップ保存</button>

  <script>
    let songs = [
      { title: "Lemon", artist: "米津玄師", genre: "J-POP", memo: "https://youtu.be/SX_ViT4Ra7k", votes: 0 },
      { title: "シャルル", artist: "バルーン", genre: "ボカロ", memo: "https://youtu.be/TA5OFS_xX0c", votes: 0 }
    ];

    
    function downloadCSV() {
      const headers = ["title", "artist", "genre", "memo"];
      const rows = songs.map(song =>
        headers.map(h => JSON.stringify(song[h] || "")).join(",")
      );
      const csvContent = [headers.join(","), ...rows].join("\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      const today = new Date().toISOString().slice(0, 10);
      a.href = url;
      a.download = `${today}_utaeru_backup.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }


    function loadSongs() {
      const saved = localStorage.getItem("songs");
      if (saved) {
        songs = JSON.parse(saved);
        songs.forEach(song => { if (song.votes === undefined) song.votes = 0; });
      }
    }

    loadSongs();
  </script>
</body>
</html>
